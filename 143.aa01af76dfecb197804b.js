"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[143],{1143:(N,e,t)=>{t.r(e),t.d(e,{StoreContext:()=>Le});var h=t(5783),r=t(8922),e=t(7634),p=t(7378),n=t(621),M=t(2008),a=t(8753),R=t(9588);class F extends p.Component{constructor(e){super(e),this.state={isErrorOccurred:!1}}componentDidCatch(){this.setState(()=>({isErrorOccurred:!0}))}render(){var e=this.state["isErrorOccurred"],t=this.props["children"];return e?p.createElement("div",{className:"error-boundary"},"ERROR OCCURRED"):t}}var W=t(4935),s=t(1370),z=t(6597),B=t(5371),l=t(9590);const H={position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center"},V=e=>{var{variant:e="indeterminate",sx:t,className:r}=e;return p.createElement(l.Z,{sx:{...H,...t},className:r},p.createElement(B.Z,{variant:e}))};var o,m,j=t(6367),d=t(4776),E=t(1011),q=t(2144),G=t(2296),Y=t(4057);const X=e=>({"& .MuiAlert-root":{width:"100%",display:"flex","& .MuiAlert-message":{padding:"8px 70px 8px 0"},"& .MuiTypography-root":{color:"inherit"}},"& .MuiAlert-message":{"& .MuiTypography-root":{color:"inherit"}},"& .MuiButton-root":{position:"absolute",top:"7px",right:"43px",color:"inherit"},"& .alert":{"&-header":{fontWeight:"bold"}},[e.breakpoints.down("sm")]:{width:"380px"}}),$=e=>{const{sx:t,text:r,header:n,severity:a,autoHideDuration:s,onClose:o,action:i,snack:l=!0}=e,[c,u]=(0,p.useState)((s??0)/1e3);e=(0,d.Z)(),e=X(e),(0,p.useEffect)(()=>{s&&"function"==typeof o&&0===c&&o()},[c,s,o]),(0,p.useEffect)(()=>{const e=setInterval(()=>{u(e=>e-1)},1e3);return()=>{e&&clearTimeout(e)}},[]),e=p.createElement(G.Z,{sx:{...e,...t},onClose:o,severity:a},p.createElement(E.Z,{className:"alert alert-header"},n),p.createElement(E.Z,{className:"alert alert-content",component:"div"},r),i&&p.createElement(q.Z,{onClick:i.callback,variant:i.variant},i.text));return l?p.createElement(Y.Z,{open:!0,sx:{...X,...t}},e):e},g=()=>p.useContext(Le),f=e=>{const[t,r]=(0,n.useQueryParams)(e);return{params:t,add:e=>r({...t,...e},"push"),remove:e=>e.forEach(e=>r({[e]:void 0})),replace:e=>r(e,"replace"),clear:()=>r({},"replace")}};f.types={StringParam:n.StringParam,NumberParam:n.NumberParam,BooleanParam:n.BooleanParam,ArrayParam:n.ArrayParam},(o=o||{}).Root="/",(c=m=m||{}).Idle="Idle",c.Fetching="Fetching",c.Error="Error",c.Success="Success";const v=(r,n)=>{const a=g()["api"],[e,s]=p.useState(m.Idle),[t,o]=p.useState(null),[i,l]=p.useState(null),[c,u]=p.useState(null);var d=p.useCallback(async(...e)=>{s(m.Idle),s(m.Fetching);var t=a.module[r],t=await t[n].bind(t)(...e);l(t.statusCode),u(t.headers),t.error?s(m.Error):(s(m.Success),o(t.data))},[a.module,r,n]);return{fetchingState:e,statusCode:i,resultData:t,resultHeaders:c,fetchStates:m,[n]:d,reset:()=>{s(m.Idle),o(null),l(null),u(null)}}},S=()=>{var e=(0,r.$G)()["t"];return{...p.useContext(r.OO),t:e}},Q={a:{textDecoration:"none",color:"inherit"},"#root":{padding:"0 15px"}},K=(0,s.Pi)(e=>{var e=e["children"],t={"& .notify-stack":{position:"fixed",top:"50px",right:"50px",zIndex:"10000 !important","& .MuiSnackbar-root":{width:"475px",display:"block",position:"relative",marginBottom:"10px"},[(0,d.Z)().breakpoints.down("sm")]:{bottom:"20px",top:"auto",left:"50%",marginLeft:"-190px","& .MuiSnackbar-root":{width:"380px",left:"auto",right:"auto"}}}};const[r,n]=(0,p.useState)(0),{i18n:a,t:s}=S(),{notifications:o,removeNotification:i}=g().rootStore;return p.createElement(p.Fragment,null,p.createElement(j.Z,{styles:Q}),p.createElement(l.Z,null,["ru","en"].map((e,t)=>p.createElement(q.Z,{key:t,variant:"contained",sx:{m:1},onClick:()=>{n(r+1),a.changeLanguage(e)},disabled:e===a.resolvedLanguage},e.toUpperCase()))),p.createElement(E.Z,null,s("common.change_language_counter",{count:r})),e,p.createElement(l.Z,{sx:t},p.createElement(l.Z,{className:"notify-stack"},o.map(e=>{var{header:t,text:r,severity:n,action:a,id:s}=e;return p.createElement($,{key:s,severity:n,header:t,text:r,onClose:()=>i(e),action:a,autoHideDuration:5e3})}))))}),i=((c=u=u||{}).Initialization="Initialization",c.Initialized="Initialized",c.InitializationError="InitializationError",u),J=()=>p.createElement(p.Fragment,null,p.createElement("h1",{style:{textAlign:"center"}},"404.",p.createElement("br",null),p.createElement("small",null,"Page not found")),p.createElement(h.rU,{className:"link",to:"/"},"Go to main"));var k=t(5484),ee=t(3386),b=t(9459),te=t(5667),re=t(6201),c=t(8790),ne=t.n(c);const ae=({size:t="medium",adornment:r,adornmentPosition:n,alwaysShowAdornment:a=!0,focused:s,autoFocus:o,hiddenLabel:i,InputProps:l,fieldRef:c,inputRef:u,mask:e,maskChar:d,pattern:h,...m})=>{var g=e=>{return p.createElement(te.Z,{...e,ref:c,inputRef:u,size:t,disabled:m.disabled,focused:s,autoFocus:o,hiddenLabel:i,autoComplete:"off",InputProps:l||(r&&(a||m.value)?{["end"===(e=n??"start")?"endAdornment":"startAdornment"]:p.createElement(re.Z,{position:e},r)}:void 0)})};return e&&!h?p.createElement(ne(),{...m,mask:e,maskChar:d},g):g({...m,onChange:e=>{e.target.value&&h?h.test(e.target.value)&&m.onChange&&m.onChange(e):m.onChange&&m.onChange(e)}})};var u=t(5),y=t.n(u),se=t(1120);const C=({variant:e="contained",type:t,disabled:r,size:n,loading:a,sx:s,href:o,className:i,text:l,children:c,onClick:u,...d})=>{e=p.createElement(se.Z,{variant:e,type:t,disabled:r,size:n,loading:a,sx:s,className:y()("button",(r||a)&&"button-disabled",i),onClick:u,...d},l||c);return o?p.createElement(h.rU,{to:o,className:"button-link"},e):e};var oe=t(2189),ie=t(374),le=t(7157);const ce=({label:e,name:t,checked:r,disabled:n,text:a,onChange:s})=>{t=p.createElement(oe.Z,{"aria-label":"is-complete-sign",name:t,checked:r,disabled:n,onChange:s}),r=a&&p.createElement(le.Z,null,a);return e?p.createElement(p.Fragment,null,p.createElement(ie.Z,{label:e,control:t}),r):p.createElement(p.Fragment,null,t,r)};c=t(2709),u=t(6185);const ue=(0,c.ZP)(u.Z)(({theme:e})=>({...e.typography.body2,padding:e.spacing(1),color:e.palette.text.secondary,boxShadow:"none","&.completed":{opacity:.5,textDecorationLine:"line-through"},"&.MuiPaper-root":{width:"100%"},"& .MuiFormHelperText-root":{position:"absolute",bottom:"-21px",margin:0}})),de=({title:e,id:t,disabled:r,completed:n,onDelete:a,onChangeTask:s})=>{const[o,i]=(0,p.useState)(!1),{t:l,i18n:c}=S(),u=(0,ee.TA)({initialValues:{title:""},validationSchema:k.Ry({title:k.Z_().required(()=>c.t("error.required_field")).min(6,({min:e})=>c.t("error.min_symbols",{symbols:e}))}),onSubmit(e){i(!1),s({id:t,completed:n,...e})}});return p.createElement(b.ZP,{container:!0,lg:12,p:1},p.createElement(b.ZP,{item:!0,xs:9,style:{display:"flex",alignItems:"center"}},p.createElement(ce,{checked:n,onChange:()=>s({title:e,id:t,completed:!n})}),p.createElement(ue,{className:y()(n&&"completed")},o?p.createElement(ae,{name:"title",size:"small",value:u.values.title,helperText:u.touched.title&&u.errors.title||l("main.enter_task_name"),onChange:u.handleChange,error:u.touched.title&&!!u.errors.title,autoFocus:!0,fullWidth:!0}):e)),p.createElement(b.ZP,{xs:12,sm:3,item:!0,textAlign:"right",style:{display:"flex",justifyContent:"end"}},p.createElement(C,{text:l(o?"common.confirm":"common.edit"),onClick:()=>{o?u.values.title===e?i(!1):u.handleSubmit():(u.setFieldValue("title",e),i(!0))},disabled:r||n}),p.createElement(C,{text:l("common.delete"),onClick:a,disabled:r,sx:{marginLeft:"5px"}})))};var he=t(1771);const me=({activeFilter:t,values:e,onFilterClick:r})=>{const n=S()["t"];var a={margin:"20px 0","& .MuiButtonBase-root":{"&.active":{cursor:"default",opacity:.5}},[(0,d.Z)().breakpoints.down("sm")]:{width:"100%","& .MuiButtonBase-root":{width:"100%"}}};return p.createElement(he.Z,{variant:"contained","aria-label":"Basic button group",sx:a},e.map(e=>p.createElement(C,{key:e,className:y()(e===t&&"active"),onClick:()=>r(e)},n("main.filter_"+e))))},w=["all","active","completed"],ge=()=>{const{t:e,i18n:t}=S();var r=(0,p.useMemo)(()=>({all:()=>!0,active:e=>!e.completed,completed:e=>e.completed}),[]);const{add:n,params:a}=f({filter:f.types.StringParam}),{getList:s,resultData:o}=v("task","getList"),{createTask:i,fetchingState:l,fetchStates:c}=v("task","createTask"),{deleteTask:u,fetchingState:d}=v("task","deleteTask"),{changeTask:h,fetchingState:m}=v("task","changeTask"),g=(0,ee.TA)({initialValues:{title:""},validationSchema:k.Ry({title:k.Z_().required(()=>t.t("error.required_field")).min(6,({min:e})=>t.t("error.min_symbols",{symbols:e}))}),onSubmit(e){i(e),g.resetForm()}});return p.useEffect(()=>{s()},[s]),(0,p.useEffect)(()=>{a.filter||n({filter:w[0]})},[a.filter,n]),(0,p.useEffect)(()=>{l===c.Success&&s()},[s,l,c.Success]),(0,p.useEffect)(()=>{d===c.Success&&s()},[s,d,c.Success]),(0,p.useEffect)(()=>{m===c.Success&&s()},[s,m,c.Success]),p.createElement(p.Fragment,null,p.createElement(E.Z,{style:{marginTop:20,marginBottom:20},variant:"h4"},e("main.project_name")),p.createElement(b.ZP,{container:!0},p.createElement(b.ZP,{item:!0,xs:12},p.createElement("form",{noValidate:!0,onSubmit:g.handleSubmit},p.createElement(ae,{name:"title",size:"small",value:g.values.title,label:e("control.main_input_label"),onChange:g.handleChange,error:g.touched.title&&!!g.errors.title,helperText:g.touched.title&&g.errors.title||e("main.enter_task_name"),fullWidth:!0}))),p.createElement(me,{values:w,activeFilter:a.filter??w[0],onFilterClick:e=>n({filter:e})})),p.createElement(b.ZP,{container:!0,spacing:2,padding:1,direction:"row",alignItems:"center"},o&&o.filter(r[a.filter]??r.all).map(t=>p.createElement(de,{key:t.id,onDelete:()=>u(t.id),onChangeTask:e=>h(t.id,e),disabled:[d,l,m].includes(c.Fetching),...t}))))};var c=(0,s.Pi)(()=>{var e=g();const{state:t,init:r}=e.rootStore,n=(0,W.V$)([{path:o.Root,children:[{index:!0,element:p.createElement(ge,null)}]},{path:"*",element:p.createElement(J,null)}]);p.useEffect(()=>{r()},[r]);e=(()=>{switch(t){case i.Initialization:return p.createElement(V,null);case i.Initialized:return p.createElement(K,null,n);default:i.InitializationError;return null}})();return p.createElement(p.Fragment,null,p.createElement(z.ZP,null)," ",e)}),u=t(6495),pe=t(3067),Ee=t(1425);const fe=class{constructor(e){this.root=e,this.state=i.Initialization,this.notifications=[],(0,R.makeAutoObservable)(this,{},{autoBind:!0})}setState(e){this.state=e}addNotification(e){this.notifications=[...this.notifications,e]}removeNotification(t){this.notifications=this.notifications.filter(e=>e!==t)}responseErrorInterceptor(e){if(pe.Z.isAxiosError(e)){const r=e?.response?.headers||{};var t="ECONNABORTED"===e.code?e?.config?.headers?.["X-Correlation-ID"]:null,e="ECONNABORTED"===e.code?"Истекло время ожидания ответа. Повторите попытку позже.":"Произошла ошибка";this.addNotification({header:e||"Ошибка запроса.",text:t??(()=>{for(var[e,t]of Object.entries(r))if("x-correlation-id"===e.toLowerCase())return t;return"Что-то пошло не так"})(),severity:"error",type:"toast",id:(0,Ee.Z)()})}}async init(){setTimeout(()=>this.setState(i.Initialized),1e3)}};class x{constructor(e,t){this.httpService=e,this.config=t}async get(e){var t=x.generateUuid();return x.invoke(this.httpService.get(x.sanitizeUrlString(""+this.config.baseUrl+e),this.getConfig(t)),t)}async post(e,t){var r=x.generateUuid();return x.invoke(this.httpService.post(x.sanitizeUrlString(""+this.config.baseUrl+e),t,this.getConfig(r)),r)}async put(e,t){var r=x.generateUuid();return x.invoke(this.httpService.put(x.sanitizeUrlString(""+this.config.baseUrl+e),t,this.getConfig(r)),r)}async patch(e,t){var r=x.generateUuid();return x.invoke(this.httpService.patch(x.sanitizeUrlString(""+this.config.baseUrl+e),t,this.getConfig(r)),r)}async delete(e){var t=x.generateUuid();return x.invoke(this.httpService.delete(x.sanitizeUrlString(""+this.config.baseUrl+e),this.getConfig(t)),t)}getConfig(e){return{headers:{...this.config.headers,"X-Correlation-ID":e,Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}}}static async invoke(e,t){try{var{statusCode:r,headers:n,error:a,data:s}=await e;return{statusCode:r,xCorrelationID:t,headers:n,data:s,error:a}}catch(e){return e}}static sanitizeUrlString(e){return e.replace(/([^:])(\/\/+)/g,"$1/")}static generateUuid(){return(0,Ee.Z)()}}class ve extends x{async getList(){return super.get("/tasks")}async createTask(e){return super.post("/tasks",e)}async deleteTask(e){return super.delete("/tasks/"+e)}async changeTask(e,t){return super.patch("/tasks/"+e,t)}}var Se=t(542);class ke extends Error{constructor(e,t){super(e),this.meta=t,this.name=this.constructor.name}}class I{constructor(e){this.http=e.create({timeout:I.DEFAULT_TIMEOUT})}get service(){return this.http}async get(e,t={}){return this.http.get(e,t).then(e=>I.responseSuccessHandler(e)).catch(e=>I.responseErrorHandler(e))}async post(e,t,r={}){return this.http.post(e,t,r).then(e=>I.responseSuccessHandler(e)).catch(e=>I.responseErrorHandler(e))}async put(e,t,r={}){return this.http.put(e,t,r).then(e=>I.responseSuccessHandler(e)).catch(e=>I.responseErrorHandler(e))}async patch(e,t,r={}){return this.http.patch(e,t,r).then(e=>I.responseSuccessHandler(e)).catch(e=>I.responseErrorHandler(e))}async delete(e,t={}){return this.http.delete(e,t).then(e=>I.responseSuccessHandler(e)).catch(e=>I.responseErrorHandler(e))}static responseSuccessHandler(e){var{status:e,data:t,headers:r}=e;return{statusCode:e,data:t,headers:r,error:null}}static responseErrorHandler(e){throw new ke("Http request error",{...e,...e.response?{status:e.response.status,data:null,headers:e.response.headers}:{}})}}I.DEFAULT_TIMEOUT=1e4;s=new I(pe.Z);class L{static getConfig(){return{IS_PRODUCTION_MODE:!0,BASE_API_URL:"/api/",PWA_MODE:"true"==="true".toLowerCase(),SW_FILE_NAME:"service-worker",SW_DEVELOPMENT_MODE_ENABLE:"true"==="false".toLowerCase(),LOGLEVEL:parseInt("3",10)}}}new L;var Z,_=t(7693),be=t.n(_),_=t(6600),ye=t.n(_);(_=Z=Z||{})[_.Error=0]="Error",_[_.Warn=1]="Warn",_[_.Info=2]="Info",_[_.Debug=3]="Debug";const Ce={[Z.Info]:[Z.Info,Z.Warn,Z.Error],[Z.Warn]:[Z.Warn,Z.Error],[Z.Error]:[Z.Error],[Z.Debug]:[Z.Debug,Z.Info,Z.Warn,Z.Error]};class T{constructor(e=Z.Error){this.logLevel=e}info(e,t){this.shouldLog(Z.Info)&&T.log(e,t,"info")}warn(e,t){this.shouldLog(Z.Warn)&&T.log(e,t,"warn")}error(e,t){this.shouldLog(Z.Error)&&T.log(e,t,"error")}debug(e,t){this.shouldLog(Z.Debug)&&T.log(e,t,"debug")}getLogLevel(){return this.logLevel}static log(e,t,r){console.groupCollapsed(`[${be().extend(ye()).utc().format(T.UTC_FORMAT)}] `+e),console["debug"===r?"log":r](t),console.groupEnd()}shouldLog(e){return Ce[this.logLevel].includes(e)}}T.UTC_FORMAT="YYYY-MM-DDTHH:mm:ss.SSS[Z]";var we=t(8003);class P{constructor(e,t){this.swPath=e,this.logger=t}register(){try{this.wb=new we.ZW(this.swPath),this.wb.register().then(t=>{t&&(this.logger.info("Service worker.","Service worker registered successfully."),t.addEventListener("updatefound",()=>{const e=t.installing;null!=e&&e.addEventListener("statechange",()=>{"installed"===e.state&&(navigator.serviceWorker.controller?this.logger.info("Service worker.","New content is available and will be used when all tabs are closed."):this.logger.info("Service worker.","Content is cached for offline use."))})}))}).catch(e=>{this.logger.error("Service worker error","Something went wrong during service worker registration."),this.logger.error("Service worker error",e.message)})}catch(e){this.logger.error("Service worker error","Something went wrong."),this.logger.error("Service worker error",e.message)}}unregister(){P.IS_SERVICE_AVAILABLE?navigator.serviceWorker.getRegistrations().then(e=>{if(e.length){for(var t of e)t.unregister();this.clearCache(),this.logger.info("Service worker unregister process.","Service worker unregistered successfully.")}}).catch(e=>{this.logger.error("Service worker error","Something went wrong during unregister process."),this.logger.error("Service worker error",e.message)}):this.logger.info("Service worker.","No serviceWorker found.")}async clearCache(){this.logger.info("Service worker.","Clearing cache store...");for(const e of await caches.keys())caches.delete(e);this.logger.info("Service worker.","Cache store was cleared successfully.")}}P.IS_SERVICE_AVAILABLE="serviceWorker"in navigator;const xe=(0,t(4366).Z)({palette:{},typography:{},components:{MuiButton:{styleOverrides:{root:{}}}}});var _=t(2501),A=t(1238),D=t(1439),t=t(7061);_.ZP.use(D.Z).use(A.Z).use(r.Db).init({detection:{convertDetectedLanguage:e=>e.split("-")[0]},debug:"production"!==t.env.ENV&&!0,fallbackLng:"ru"});const Ie=_.ZP;var{IS_PRODUCTION_MODE:D,BASE_API_URL:A,PWA_MODE:t,SW_FILE_NAME:_,SW_DEVELOPMENT_MODE_ENABLE:U}=L.getConfig(),a=(D||((0,a.U7)({action:!0,reaction:!0,transaction:!0,compute:!0}),(0,R.configure)({computedRequiresReaction:!0,reactionRequiresObservable:!0})),new T(L.getConfig().LOGLEVEL));const O=new class{constructor(e){this.api=e,this.rootStore=new fe(this)}}(new class extends class{constructor(e){this.http=e,this.config={baseUrl:"",headers:{}}}configure(e){return Object.assign(this.config,e),this}moduleFactory(e){return new e(this.http,this.config)}}{constructor(){super(...arguments),this.module={task:this.moduleFactory(ve)}}}(s).configure({baseUrl:A})),Le=p.createContext(O);A=new P(_+".js",a);(D||U)&&t&&A.register(),t||A.unregister();{_=s,a={onResponseError:O.rootStore.responseErrorInterceptor},_=_.service;const Ze=a["onResponseError"];_.interceptors.response.use(e=>e,e=>{var t=e?.response?.headers||{};switch(e?.response?.status){case Se.W.GATEWAY_TIMEOUT:break;case Se.W.UNAUTHORIZED:return t&&t.location&&(window.location.href=t.location),Promise.reject(e);default:Ze&&Ze(e)}return Promise.reject(e)})}D=c,(U=document.getElementById("root"))&&e.createRoot(U).render(p.createElement(u.Z,{theme:xe},p.createElement(Le.Provider,{value:O},p.createElement(F,null,p.createElement(h.VK,null,p.createElement(n.QueryParamProvider,{adapter:M.Q},p.createElement(r.a3,{i18n:Ie},p.createElement(D,null))))))))}}]);