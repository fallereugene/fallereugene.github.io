"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[780],{7780:(W,e,t)=>{t.r(e),t.d(e,{StoreContext:()=>M,renderApplication:()=>xe});var U=t(7470),d=t(3696),g=t(9348),n=t(9315),e=t(998),r=t(9193);class P extends d.Component{constructor(e){super(e),this.state={isErrorOccurred:!1}}componentDidCatch(){this.setState(()=>({isErrorOccurred:!0}))}render(){var e=this.state["isErrorOccurred"],t=this.props["children"];return e?d.createElement("div",{className:"error-boundary"},"ERROR OCCURED"):t}}const B=(e,t)=>{switch(t.type){case"ADD_CRUMB":return e.concat(t.payload).sort((e,t)=>e.pathname.length-t.pathname.length);case"REMOVE_CRUMB":return e.filter(({id:e})=>e!==t.payload.id);default:return e}},F=(0,d.createContext)({});const z=({children:e})=>{const[t,r]=(0,d.useReducer)(B,[]),n=d.useCallback(e=>r({type:"ADD_CRUMB",payload:e}),[]),o=d.useCallback(e=>r({type:"REMOVE_CRUMB",payload:e}),[]);var s=d.useMemo(()=>({crumbs:t,add:n,remove:o}),[t,n,o]);return d.createElement(F.Provider,{value:s},e)};var V=t(6307),X=t(7435),o=t(95),H=t(705),i=t(527);const j={position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center"},Y=e=>{var{variant:e="indeterminate",sx:t,className:r}=e;return d.createElement(i.A,{sx:{...j,...t},className:r},d.createElement(H.A,{variant:e}))};var q=t(4147),m=t(7109),p=t(1455),G=t(8016),K=t(2892);const E={minWidth:"475px","& .MuiAlert-root":{width:"100%",display:"flex","& .MuiAlert-message":{padding:"8px 70px 8px 0"},"& .MuiTypography-root":{color:"inherit"}},"& .MuiAlert-message":{"& .MuiTypography-root":{color:"inherit"}},"& .MuiButton-root":{position:"absolute",top:"7px",right:"43px",color:"inherit"},"& .alert":{"&-header":{fontWeight:"bold"}}},J=e=>{const{sx:t,text:r,header:n,severity:o,autoHideDuration:s,onClose:a,action:i,className:c,snack:l=!0}=e,[h,u]=(0,d.useState)((s??0)/1e3);(0,d.useEffect)(()=>{s&&"function"==typeof a&&0===h&&a()},[h,s,a]),(0,d.useEffect)(()=>{const e=setInterval(()=>{u(e=>e-1)},1e3);return()=>{e&&clearTimeout(e)}},[]);e=d.createElement(G.A,{sx:{...E,...t},onClose:a,severity:o,className:c},d.createElement(m.A,{className:"alert alert-header"},n),d.createElement(m.A,{className:"alert alert-content",component:"div"},r),i&&d.createElement(p.A,{onClick:i.callback,variant:i.variant},i.text));return l?d.createElement(K.A,{open:!0,sx:{...E,...t},className:c},e):e},v=()=>d.useContext(M);var s=t(5837),Z=t(7748);const $=({children:e})=>d.createElement(s.QueryParamProvider,{adapter:Z.S},e);var c,f;s.StringParam,s.NumberParam,s.BooleanParam,s.ArrayParam,(a=c=c||{}).Initialization="Initialization",a.Initialized="Initialized",a.InitializationError="InitializationError",(a=f=f||{}).Idle="Idle",a.Fetching="Fetching",a.Error="Error",a.Success="Success";const h=(r,n)=>{const o=v()["api"],[e,s]=d.useState(f.Idle),[t,a]=d.useState(null),[i,c]=d.useState(null),[l,h]=d.useState(null);var u=d.useCallback(async(...e)=>{s(f.Idle),s(f.Fetching);var t=o.modules[r],t=await t[n].bind(t)(...e);c(t.statusCode),h(t.headers),t.error?s(f.Error):(s(f.Success),a(t.data))},[o.modules,r,n]);return{fetchingState:e,statusCode:i,resultData:t,resultHeaders:l,FetchState:f,[n]:u,reset:()=>{s(f.Idle),a(null),c(null),h(null)}}},u=()=>{var e=(0,n.Bd)()["t"];return{...d.useContext(n.gJ),t:e}},Q={a:{textDecoration:"none",color:"inherit"},"#root":{padding:"0 15px"}},ee={display:"flex",maxWidth:1920,margin:"auto","& .main.MuiBox-root":{flexGrow:1,p:3,padding:"50px 75px",position:"relative",minHeight:"100vh"},"& .notify-stack":{position:"fixed",top:"50px",right:"50px",zIndex:"10000 !important","& .MuiSnackbar-root":{minWidth:"475px",display:"block",position:"relative",marginBottom:"10px"}}},te=(0,o.PA)(e=>{e=e.children;const[r,n]=(0,d.useState)(0),{notifications:t,removeNotification:a}=v().rootStore,{i18n:o,t:s}=u();return d.createElement(d.Fragment,null,d.createElement(q.A,{styles:Q}),d.createElement(i.A,{p:2},["ru","en"].map((e,t)=>d.createElement(p.A,{key:t,variant:"contained",sx:{m:1},onClick:()=>{n(r+1),o.changeLanguage(e)},disabled:e===o.resolvedLanguage},e.toUpperCase())),d.createElement(m.A,null,s("common.change_language_counter",{count:r})),e,d.createElement(i.A,{sx:ee},d.createElement(i.A,{className:"notify-stack"},t.map(e=>{var{header:t,text:r,severity:n,action:o,id:s}=e;return d.createElement(J,{key:s,severity:n,header:t,text:r,onClose:()=>a(e),action:o,autoHideDuration:5e3})})))))}),re=()=>d.createElement(d.Fragment,null,d.createElement("h1",{style:{textAlign:"center"}},"404.",d.createElement("br",null),d.createElement("small",null,"Page not found")),d.createElement(g.N_,{className:"link",to:"/"},"Go to main"));var b=t(3452),ne=t(4101),C=t(4091),oe=t(7055),se=t(171);const ae={margin:"5px 0",marginBottom:"20px","& .MuiFormHelperText-root":{marginLeft:0}},ie=({size:e="medium",adornment:t,adornmentPosition:r,alwaysShowAdornment:n=!0,focused:o,autoFocus:s,hiddenLabel:a,InputProps:i,fieldRef:c,inputRef:l,...h})=>{var u;return u={...h},d.createElement(oe.A,{...u,ref:c,inputRef:l,size:e,disabled:h.disabled,focused:o,autoFocus:s,hiddenLabel:a,autoComplete:"off",InputProps:i||(t&&(n||h.value)?{["end"===(u=r??"start")?"endAdornment":"startAdornment"]:d.createElement(se.A,{position:u},t)}:void 0),sx:ae})};var a=t(4452),ce=t.n(a),le=t(8511);const y=({text:e,variant:t="contained",type:r,disabled:n,size:o,loading:s,sx:a,href:i,className:c,children:l,onClick:h,...u})=>{t=d.createElement(le.A,{variant:t,type:r,disabled:n,size:o,loading:s,sx:a,className:ce()("button",(n||s)&&"button-disabled",c),onClick:h,...u},e||l);return i?d.createElement(g.N_,{to:i,className:"button-link"},t):t};var l,a=t(7308),S=t(3998);const he=(0,a.Ay)(S.A)(({theme:e})=>({...e.typography.body2,padding:e.spacing(1),color:e.palette.text.secondary,boxShadow:"none"})),ue=({title:e,disabled:t,onDelete:r})=>{var n=u()["t"];return d.createElement(d.Fragment,null,d.createElement(C.Ay,{item:!0,xs:10},d.createElement(he,null,e)),d.createElement(C.Ay,{xs:2,item:!0,textAlign:"right"},d.createElement(y,{text:n("common.delete"),onClick:r,disabled:t})))},de=()=>{const{getList:e,resultData:t}=h("todos","getList"),{fetchingState:r,deleteTask:n,FetchState:o}=h("todos","deleteTask"),{fetchingState:s,createTask:a}=h("todos","createTask"),{t:i,i18n:c}=u(),l=(0,ne.Wx)({initialValues:{title:""},validationSchema:b.Ik({title:b.Yj().required(()=>c.t("error.required_field")).min(6,({min:e})=>c.t("error.min_symbols",{symbols:e}))}),onSubmit(e){a(e)}});return(0,d.useEffect)(()=>{e()},[e]),(0,d.useEffect)(()=>{s===o.Success&&e()},[e,s,o.Success]),(0,d.useEffect)(()=>{r===o.Success&&e()},[e,r,o.Success]),d.createElement(d.Fragment,null,d.createElement(m.A,{style:{marginTop:20,marginBottom:20},variant:"h4"},i("main.project_name")),d.createElement(C.Ay,{container:!0},d.createElement(C.Ay,{item:!0,xs:12},d.createElement("form",{noValidate:!0,onSubmit:l.handleSubmit},d.createElement(ie,{name:"title",size:"small",value:l.values.title,label:i("control.main_input_label"),onChange:l.handleChange,error:l.touched.title&&!!l.errors.title,helperText:l.touched.title&&l.errors.title||i("main.enter_task_name"),fullWidth:!0}),d.createElement(y,{onClick:()=>l.handleSubmit(),disabled:[r,s].includes(o.Fetching)},i("common.confirm"))))),d.createElement(C.Ay,{container:!0,spacing:2,padding:1,direction:"row",alignItems:"center"},t&&t.map(e=>d.createElement(ue,{key:e.id,onDelete:()=>n(e.id),disabled:[r,s].includes(o.Fetching),...e}))))};(l=l||{}).Root="/";const ge=(0,o.PA)(e=>{var e=e["targetUrlSegment"],t=v();const{eventConnector:r,logger:n}=t,{state:o,init:s}=t.rootStore;t=(0,X.Ye)((t=e,[{path:(e=l.Root,(t=t)?(t+"/"+e).replace(/\/+/g,"/"):e),children:[{index:!0,element:d.createElement(de,null)}]},{path:"*",element:d.createElement(re,null)}]));const a=(0,d.useCallback)(({id:e})=>{n.info("Root component",`Item with id ${e} was deleted successfully.`)},[n]);return d.useEffect(()=>(s(),r.on("test_event_name",a),()=>{r.off("test_event_name",a)}),[r,a,s]),d.createElement(d.Fragment,null,d.createElement(V.Ay,null)," ",o===c.Initialization?d.createElement(Y,null):d.createElement(te,null,t))});var me=t(3653);const pe=class{constructor(e){this.root=e,this.state=c.Initialization,this.notifications=[],(0,r.makeAutoObservable)(this,{},{autoBind:!0})}setState(e){this.state=e}addNotification(e){this.notifications=[...this.notifications,e]}removeNotification(t){this.notifications=this.notifications.filter(e=>e.id!==t.id)}async init(){setTimeout(()=>this.setState(c.Initialized),1e3)}};a=t(6827);class A extends t.n(a)(){constructor(e){super(),this.logger=e,this.timerId=null}connect(e){this.logger.info("Websocket client","connecting: "+e),this.url=e,this.ws=new WebSocket(this.url),this.bindContext(),this.addEvents()}async disconnect(){this.logger.info("Websocket client","disconnecting: "+this.url),this.ws.close()}on(e,t){return super.on(e,t),this}off(e,t){return super.off(e,t),this}bindContext(){this.onMessage=this.onMessage.bind(this),this.onOpen=this.onOpen.bind(this),this.onClose=this.onClose.bind(this),this.onError=this.onError.bind(this)}addEvents(){this.ws.addEventListener("open",this.onOpen),this.ws.addEventListener("close",this.onClose),this.ws.addEventListener("error",this.onError),this.ws.addEventListener("message",this.onMessage)}onOpen(){this.logger.info("Websocket client. onOpen event","connection opened: "+this.url),this.timerId&&clearInterval(this.timerId)}onClose(){this.logger.warn("Websocket client. onClose event","connection closed: "+this.url),this.timerId&&clearInterval(this.timerId),this.timerId=setInterval(()=>this.connect(this.url),A.RECONNECTION_TIMEOUT)}onError(e){this.logger.error("Websocket client. onError event",e)}onMessage(t){try{var e=JSON.parse(t.data)["payload"];this.logger.debug("Websocket client. onMessage event",{payload:e});super.emit("test_event_name",e)}catch(e){this.logger.error("Websocket client exception: onMessage event",t.data)}}}A.RECONNECTION_TIMEOUT=5e3;var k=t(5745);class I{constructor(e,t){this.http=e,this.config=t}async get(e){var t=I.generateXCorrelationID();return I.invoke(this.http.get(I.removeDoubleSlash(""+this.config.baseUrl+e),this.getConfig(t)),t)}async post(e,t){var r=I.generateXCorrelationID();return I.invoke(this.http.post(I.removeDoubleSlash(""+this.config.baseUrl+e),t,this.getConfig(r)),r)}async put(e,t){var r=I.generateXCorrelationID();return I.invoke(this.http.put(I.removeDoubleSlash(""+this.config.baseUrl+e),t,this.getConfig(r)),r)}async patch(e,t){var r=I.generateXCorrelationID();return I.invoke(this.http.patch(I.removeDoubleSlash(""+this.config.baseUrl+e),t,this.getConfig(r)),r)}async delete(e){var t=I.generateXCorrelationID();return I.invoke(this.http.delete(I.removeDoubleSlash(""+this.config.baseUrl+e),this.getConfig(t)),t)}static async invoke(e,t){try{var{statusCode:r,headers:n,error:o,data:s}=await e;return{statusCode:r,xCorrelationID:t,headers:n,data:s,error:o}}catch(e){return e}}getConfig(e){return{headers:{...this.config.headers,"X-Correlation-Id":e,Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}}}static generateXCorrelationID(){return(0,k.A)()}static removeDoubleSlash(e){return e.replace(/\/+/g,"/")}}class Ee extends I{async getList(){return super.get("/todos")}async createTask(e){return super.post("/todos",e)}async deleteTask(e){return super.delete("/todos/"+e)}}var ve=t(174);var fe=t(9496),S=t(1348);class be extends Error{constructor(e,t){super(e),this.meta=t,this.name=this.constructor.name}}class w{constructor(e){this.http=e.create({timeout:w.DEFAULT_TIMEOUT}),this.enableRetry()}get service(){return this.http}async get(e,t){return this.http.get(e,t).then(e=>w.handleSuccess(e)).catch(e=>w.handleError(e,t))}async post(e,t,r){return this.http.post(e,t,r).then(e=>w.handleSuccess(e)).catch(e=>w.handleError(e,r))}async put(e,t,r){return this.http.put(e,t,r).then(e=>w.handleSuccess(e)).catch(e=>w.handleError(e,r))}async patch(e,t,r){return this.http.patch(e,t,r).then(e=>w.handleSuccess(e)).catch(e=>w.handleError(e,r))}async delete(e,t){return this.http.delete(e,t).then(e=>w.handleSuccess(e)).catch(e=>w.handleError(e,t))}static handleSuccess(e){var{status:e,data:t,headers:r}=e;return{statusCode:e,data:t,headers:r,error:null}}static handleError(e,t){throw new be("Http request error",{...e,...e.response?{status:e.response.status,data:null,headers:e.response.headers}:{},...t})}enableRetry(){(0,fe.Ay)(this.http,{retries:w.MAX_RETRY_ATTEMPT,retryCondition(e){return e.response?.status,!1}})}}w.MAX_RETRY_ATTEMPT=3,w.DEFAULT_TIMEOUT=1e4;var o=new w(S.A),Ce=t(3048);class x{constructor(e,t){this.swPath=e,this.logger=t}async register(){try{x.IS_SERVICE_AVAILABLE?(x.wb=new Ce.JK(this.swPath),x.wb.register().then(t=>{this.logger.info("ServiceWorker","Service worker registered successfully."),t?.addEventListener("updatefound",()=>{const e=t.installing;e?.addEventListener("statechange",()=>{"installed"===e.state&&(navigator.serviceWorker.controller?this.logger.info("ServiceWorker","New content is available and will be used when all tabs are closed."):this.logger.info("ServiceWorker","Content is cached for offline use."))})})}).catch(e=>{this.logger.error("ServiceWorker","Something went wrong during service worker registration."),this.logger.error("ServiceWorker",e.message)})):this.logger.error("ServiceWorker","Your browser does not support the service workers.")}catch(e){this.logger.error("ServiceWorker","Something went wrong."),this.logger.error("ServiceWorker",e.message)}}async unregister(){x.IS_SERVICE_AVAILABLE?navigator.serviceWorker.getRegistrations().then(e=>{if(e.length){for(var t of e)t.unregister();this.clearCache(),this.logger.info("Service worker unregister process.","Service worker unregistered successfully.")}}).catch(e=>{this.logger.error("ServiceWorker","Something went wrong during unregister process."),this.logger.error("ServiceWorker",e.message)}):this.logger.info("ServiceWorker","No serviceWorker found.")}async clearCache(){this.logger.info("ServiceWorker","Clearing cache store...");for(const e of await caches.keys())caches.delete(e);this.logger.info("ServiceWorker","Cache store was cleared successfully.")}}x.IS_SERVICE_AVAILABLE="serviceWorker"in navigator;var _,a=t(5285),ye=t.n(a),S=t(4486),Se=t.n(S);(a=_=_||{})[a.Error=0]="Error",a[a.Warn=1]="Warn",a[a.Info=2]="Info",a[a.Debug=3]="Debug";const Ae={[_.Info]:[_.Info,_.Warn,_.Error],[_.Warn]:[_.Warn,_.Error],[_.Error]:[_.Error],[_.Debug]:[_.Debug,_.Info,_.Warn,_.Error]};class L{constructor(e=_.Error){this.logLevel=e}info(e,t){this.shouldLog(_.Info)&&L.log(e,t,"info")}warn(e,t){this.shouldLog(_.Warn)&&L.log(e,t,"warn")}error(e,t){this.shouldLog(_.Error)&&L.log(e,t,"error")}debug(e,t){this.shouldLog(_.Debug)&&L.log(e,t,"debug")}getLogLevel(){return this.logLevel}static log(e,t,r){console.groupCollapsed(`[${ye().extend(Se()).utc().format(L.UTC_FORMAT)}] `+e),console["debug"===r?"log":r](t),console.groupEnd()}shouldLog(e){return Ae[this.logLevel].includes(e)}}L.UTC_FORMAT="YYYY-MM-DDTHH:mm:ss.SSS[Z]";class D{static getConfig(){return{IS_PRODUCTION_MODE:!0,WEB_SOCKET_HUB_CONNECTION_URL:"ws://localhost:8444",BASE_API_URL:"/api/",LOGLEVEL:parseInt("3",10),PWA_MODE_ENABLED:"true"==="true".toLowerCase(),PWA_MODE_DEVELOPMENT_ENABLED:"true"==="false".toLowerCase()}}}new D;const ke=(0,t(7890).A)({palette:{},typography:{},components:{MuiButton:{styleOverrides:{root:{}}}}});var S=t(4337),a=t(8499),O=t(7369),T=t(8538);S.Ay.use(O.A).use(a.A).use(n.r9).init({detection:{convertDetectedLanguage:e=>e.split("-")[0]},debug:"production"!==T.env.ENV&&!0,fallbackLng:"ru",backend:{loadPath:t.p+"/locales/{{lng}}/{{ns}}.json"}});const Ie=S.Ay;var{IS_PRODUCTION_MODE:O,BASE_API_URL:a,WEB_SOCKET_HUB_CONNECTION_URL:T,PWA_MODE_ENABLED:t,PWA_MODE_DEVELOPMENT_ENABLED:S}=D.getConfig(),e=(O||((0,e.TS)({action:!0,reaction:!0,transaction:!0,compute:!0}),(0,r.configure)({computedRequiresReaction:!0,reactionRequiresObservable:!0})),new L(D.getConfig().LOGLEVEL));const N=new class{constructor(e,t,r){this.api=e,this.eventConnector=t,this.logger=r,this.rootStore=new pe(this)}}(new class extends class{constructor(e,t){this.http=e,this.logger=t,this.config={baseUrl:"",headers:{}}}configure(e){return Object.assign(this.config,e),this}get configuration(){return this.config}instantiateModule(e){return new e(this.http,this.config)}}{constructor(){super(...arguments),this.modules={todos:this.instantiateModule(Ee)}}}(o,e).configure({baseUrl:a}),new class{constructor(e,t,r){this.client=e,this.connectionUrl=t,this.logger=r,this.connectionUrl&&this.connect(this.connectionUrl)}connect(e){try{this.client.connect(e)}catch(e){this.logger.error("Event connector","The connection couldn't be established. Check connection url string.")}}disconnect(){this.client.disconnect()}on(e,t){try{this.client.on(e,t)}catch(e){this.logger.error("Event connector","Something went wrong subscribing on event. Check client instance.")}}off(e,t){try{this.client.off(e,t)}catch(e){this.logger.error("Event connector","Something went wrong unsubscribing from event. Check client instance.")}}getInstance(){return this.client}}(new A(e),T,e),e);a=new x("service-worker.js",e);const M=d.createContext(N);(O||S)&&t&&a.register(),t||a.unregister();{T=o;var we=e;O={showErrorNotification:N.rootStore.addNotification},T=T.service;const R=O["showErrorNotification"];T.interceptors.response.use(e=>e,e=>{we.error("Interceptor response",e?.response?.data),we.info("Interceptor response",e?.response);var t=e?.response?.headers||{},r=(e=>{if("ECONNABORTED"===e.code)return e?.config?.headers?.["X-Correlation-Id"];var t,r,n=e?.response?.headers||{};for([t,r]of Object.entries(n))if("x-correlation-id"===t.toLowerCase())return r;return e?.config?.headers?.["X-Correlation-Id"]??null})(e);return e?.response?.status===ve.v.UNAUTHORIZED?t&&t.location&&(window.location.href=t.location):R&&R({header:"ECONNABORTED"===e.code?"Истекло время ожидания ответа. Повторите попытку позже.":e.response?.data?.detail??"Ошибка запроса",text:r??"Что-то пошло не так",severity:"error",type:"toast",id:(0,k.A)()}),Promise.reject(e)})}const xe=e=>{var t=e=>d.createElement(me.A,{theme:ke},d.createElement(M.Provider,{value:N},d.createElement(P,null,d.createElement(g.Kd,null,d.createElement($,null,d.createElement(z,null,d.createElement(n.xC,{i18n:Ie},d.createElement(ge,{...e})))))))),r=document.getElementById("root");return r&&U.createRoot(r).render(d.createElement(t,{...e})),d.createElement(t,{...e})};xe()}}]);